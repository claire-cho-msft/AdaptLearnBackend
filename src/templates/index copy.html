<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>{{ title | default('IT Admins - Microsoft Teams deployment overview | Microsoft Learn') }}</title>
  <meta name="viewport" content="width=1024">
  <script src="https://kit.fontawesome.com/9ea6df0e2c.js" crossorigin="anonymous"></script>
  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      margin: 0;
      background: #fff;
      color: #222;
      font-size: 16px;
      line-height: 1.6;
    }

    header {
      background: #fff;
      border-bottom: 1px solid #e5e5e5;
      padding: 0 0 0 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      min-height: 56px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    header .logo {
      padding: 10px 24px 10px 24px;
      display: flex;
      align-items: center;
    }

    header .logo img {
      height: 20px;
      margin-right: 10px;
    }

    header .nav-links {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 24px;
    }

    header .nav-links a {
      color: #222;
      text-decoration: none;
      font-size: 15px;
      padding: 0 10px;
      line-height: 56px;
      display: inline-block;
    }

    header .nav-actions {
      display: flex;
      align-items: center;
      gap: 10px;
      padding-right: 24px;
    }

    header .nav-actions button,
    header .nav-actions a {
      font-size: 13px;
      padding: 6px 14px;
      border: none;
      border-radius: 2px;
      margin-left: 2px;
      cursor: pointer;
      text-decoration: none;
      color: #fff;
      background: #0067b8;
      transition: background 0.2s;
    }

    header .nav-actions button:hover,
    header .nav-actions a:hover {
      background: #005a9e;
    }

    header .nav-actions a[style*="background:#e5e5e5"] {
      background: #e5e5e5 !important;
      color: #222 !important;
      font-weight: 500;
      border: none;
    }

    header .sign-in {
      color: #0067b8;
      background: none;
      border: none;
      padding: 6px 12px;
      font-size: 15px;
      cursor: pointer;
      margin-left: 4px;
      transition: color 0.2s;
    }

    header .sign-in:hover {
      text-decoration: underline;
      color: #004578;
    }

    .breadcrumbs {
      font-size: 14px;
      color: #555;
      margin: 0;
      padding: 24px 0 0 40px;
    }

    .breadcrumbs a {
      color: #0078d4;
      text-decoration: none;
    }

    .breadcrumbs span {
      margin: 0 6px;
      color: #888;
    }

    .container {
      display: flex;
      flex-direction: row;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 24px 24px 24px;
    }

    nav.sidebar {
      min-width: 220px;
      max-width: 220px;
      margin-right: 32px;
      padding-top: 10px;
      border-right: 1px solid #eee;
      font-size: 15px;
    }

    nav.sidebar h3 {
      font-size: 16px;
      margin-top: 10px;
      margin-bottom: 8px;
      padding-left: 12px;
      font-weight: 600;
      color: #333;
    }

    nav.sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    nav.sidebar li {
      margin: 1px 0;
    }

    nav.sidebar a {
      display: block;
      padding: 7px 16px;
      color: #222;
      text-decoration: none;
      border-radius: 3px;
      transition: background 0.1s;
    }

    nav.sidebar a[aria-current="page"] {
      background: #e3f2fd;
      color: #005a9e;
      font-weight: 600;
    }

    nav.sidebar a:hover {
      background: #f3f9fd;
    }

    .main-area {
      flex: 1;
      min-width: 0;
      max-width: 800px;
      padding-top: 18px;
    }

    .right-nav {
      min-width: 220px;
      max-width: 240px;
      margin-left: 32px;
      padding-top: 18px;
      font-size: 15px;
    }

    .right-nav .in-this-article {
      background: #f3f9fd;
      border-radius: 8px;
      padding: 16px 18px 10px 18px;
      margin-bottom: 24px;
    }

    .right-nav .in-this-article h4 {
      font-size: 15px;
      color: #333;
      margin: 0 0 10px 0;
      font-weight: 600;
    }

    .right-nav ul {
      list-style: none;
      padding: 0;
      margin: 0 0 0 0;
    }

    .right-nav li {
      margin: 0 0 8px 0;
    }

    .right-nav a {
      color: #0078d4;
      text-decoration: none;
    }

    h1 {
      font-size: 2rem;
      font-weight: 700;
      margin: 0 0 10px 0;
      color: #242424;
    }

    .meta {
      font-size: 14px;
      color: #666;
      margin-bottom: 18px;
    }

    .tip-box {
      background: #eaf6ed;
      border-left: 4px solid #73b563;
      border-radius: 5px;
      padding: 18px 22px 16px 22px;
      margin: 16px 0 24px 0;
      display: flex;
      gap: 14px;
      align-items: flex-start;
    }

    .tip-box .tip-icon {
      margin-top: 2px;
      color: #339933;
      font-size: 20px;
      flex-shrink: 0;
    }

    .tip-box .tip-content {
      flex: 1;
      font-size: 15px;
      color: #265e22;
    }

    .tip-box .tip-content a {
      color: #0b6a0b;
      text-decoration: underline;
    }

    .main-area .para {
      margin-bottom: 16px;
      font-size: 16px;
    }

    .main-area a {
      color: #0078d4;
      text-decoration: underline;
    }

    .main-area .inline-green-link {
      color: #0b6a0b;
      font-weight: 500;
      text-decoration: underline;
    }

    .main-area .section {
      margin-top: 34px;
      margin-bottom: 24px;
      border-radius: 8px;
      border: 1px solid #e6e6e6;
      box-shadow: 0 1px 2px #eee;
      background: #f9f9f9;
      padding: 0 0 22px 0;
      position: relative;
    }

    .main-area .section-header {
      padding: 18px 24px 8px 24px;
      border-bottom: 1px solid #eaeaea;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .main-area .section-header h2 {
      font-size: 1.4rem;
      font-weight: 700;
      margin: 0;
      flex: 1;
      color: #222;
      /* Ensure no extra line height for alignment */
      line-height: 1.2;
      display: flex;
      align-items: center;
    }

    /* SLIDER SWITCH START */
    .switch {
      display: flex;
      align-items: center;
      height: 100%;
    }

    .switch-slider {
      width: 90px;
      height: 32px;
      display: flex;
      align-items: center;
      position: relative;
      margin-left: 18px;
      /* Remove top margin, align with heading */
      margin-top: 0;
      margin-bottom: 0;
    }

    .slider-track {
      position: relative;
      width: 100%;
      height: 12px;
      background: #e0e0e0;
      border-radius: 6px;
      /* Remove top offset to vertically center */
      top: 0;
      display: flex;
      align-items: center;
    }

    .slider-dot {
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 14px;
      height: 14px;
      background: #fff;
      border: 2.5px solid #b3b3b3;
      border-radius: 50%;
      z-index: 2;
      transition: border 0.2s, background 0.2s;
      pointer-events: none;
    }

    .slider-dot.active,
    .slider-dot.selected {
      border-color: #0078d4;
      background: #e3f2fd;
    }

    .slider-dot:nth-child(1) {
      left: 0%;
    }

    .slider-dot:nth-child(2) {
      left: 50%;
    }

    .slider-dot:nth-child(3) {
      left: 100%;
    }

    .slider-thumb {
      position: absolute;
      top: 50%;
      /* We'll set left in JS to align its center with the dot */
      width: 26px;
      height: 26px;
      background: #0078d4;
      border-radius: 50%;
      box-shadow: 0 1px 4px #bbb;
      transition: left 0.2s;
      z-index: 3;
      border: 2.5px solid #fff;
      left: 0%;
      transform: translate(-50%, -50%);
      cursor: pointer;
    }

    /* SLIDER SWITCH END */
    .main-area .section-content {
      padding: 18px 24px 0 24px;
      font-size: 16px;
    }

    .main-area .section-content ul {
      padding-left: 24px;
      margin: 8px 0 8px 0;
    }

    .main-area .section-content ul li {
      margin: 6px 0;
    }

    .main-area .section-content ul li a {
      color: #0078d4;
      text-decoration: underline;
    }

    .main-area .section-content .note-block {
      background: #eaf6ed;
      border-left: 4px solid #73b563;
      border-radius: 5px;
      padding: 14px 18px;
      margin: 20px 0 14px 0;
      color: #265e22;
      font-size: 15px;
    }

    .main-area .section-content .note-block a {
      color: #0b6a0b;
      text-decoration: underline;
    }

    .main-area .expand-table {
      display: flex;
      align-items: center;
      gap: 7px;
      font-size: 15px;
      color: #0078d4;
      cursor: pointer;
      margin: 12px 0 0 0;
      user-select: none;
    }

    .main-area .expand-table svg {
      width: 16px;
      height: 16px;
      vertical-align: middle;
      margin-right: 3px;
      fill: #0078d4;
    }

    .main-area table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      background: #fff;
      font-size: 15px;
    }

    .main-area th,
    .main-area td {
      border: 1px solid #e0e0e0;
      padding: 8px 12px;
      text-align: left;
      vertical-align: top;
    }

    .main-area th {
      background: #f3f9fd;
      color: #222;
      font-weight: 600;
    }

    .main-area td:first-child a {
      color: #0078d4;
      text-decoration: underline;
    }

    .main-area .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
      margin: 18px 0 0 0;
      font-size: 14px;
      color: #888;
    }

    .main-area .pagination .page {
      padding: 1px 8px;
      border-radius: 3px;
      font-weight: 500;
      background: #f3f9fd;
      color: #0078d4;
      border: 1px solid #e0e0e0;
      margin: 0 2px;
      cursor: pointer;
    }

    .main-area .pagination .page.current {
      background: #e3f2fd;
      color: #222;
      border: 1px solid #b3d4fc;
    }

    .feedback-section {
      margin: 40px 0 0 0;
      padding: 24px 0 0 0;
      border-top: 1px solid #e5e5e5;
      font-size: 15px;
      color: #222;
    }

    .feedback-section .feedback-question {
      margin-bottom: 8px;
      font-size: 15px;
      font-weight: 500;
    }

    .feedback-section .feedback-buttons {
      display: inline-flex;
      gap: 10px;
      margin-bottom: 10px;
    }

    .feedback-section .feedback-buttons button {
      padding: 5px 22px;
      border: 1px solid #0078d4;
      background: #fff;
      color: #0078d4;
      border-radius: 3px;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }

    .feedback-section .feedback-buttons button.selected,
    .feedback-section .feedback-buttons button:hover {
      background: #e3f2fd;
      color: #005a9e;
    }

    .feedback-section .feedback-link {
      display: block;
      color: #0078d4;
      margin-top: 10px;
      text-decoration: underline;
      font-size: 15px;
    }

    footer {
      border-top: 1px solid #e5e5e5;
      background: #fcfcfc;
      padding: 18px 24px 18px 24px;
      font-size: 13px;
      color: #555;
      display: flex;
      flex-wrap: wrap;
      gap: 18px;
      justify-content: space-between;
      align-items: center;
    }

    footer .footer-links {
      display: flex;
      gap: 14px;
      flex-wrap: wrap;
    }

    footer .footer-links a {
      color: #0078d4;
      text-decoration: none;
    }

    footer .footer-links a:hover {
      text-decoration: underline;
    }

    footer .footer-meta {
      display: flex;
      gap: 14px;
      align-items: center;
      flex-wrap: wrap;
    }

    .footer-meta .theme-select,
    .footer-meta .privacy-choice {
      display: inline-block;
      margin-right: 14px;
    }

    .footer-meta select {
      font-size: 13px;
      padding: 2px 6px;
      border-radius: 2px;
    }

    @media (max-width: 1200px) {
      .container {
        flex-direction: column;
        max-width: 100vw;
        padding: 0 8px 24px 8px;
      }

      nav.sidebar,
      .right-nav {
        max-width: 100vw;
        min-width: 0;
        margin: 0;
        border: none;
      }

      .main-area {
        max-width: 100vw;
        padding-left: 0;
        padding-right: 0;
      }
    }

    @media (max-width: 800px) {

      header,
      footer {
        flex-direction: column;
        gap: 8px;
        padding: 8px 8px;
      }

      .container {
        padding: 0 2px 24px 2px;
      }
    }
  </style>
</head>

<body>
  <header>
    <div class="logo">
      <img src="https://learn.microsoft.com/favicon.ico" alt="Microsoft logo">
      <span style="font-size: 19px; font-weight: 600; color: #0078d4;">Learn</span>
    </div>
    <nav class="nav-links" aria-label="Main navigation">
      <a href="#">Discover</a>
      <a href="#">Product documentation</a>
      <a href="#">Development languages</a>
      <a href="#">Topics</a>
    </nav>
    <div class="nav-actions">
      <a href="#" style="background:#e5e5e5; color:#222; font-weight: 500; border: none;">Developer Portal</a>
      <a href="#" style="background:#2266e3;">Download Microsoft 365 Agents Toolkit</a>
      <button class="sign-in">Sign in</button>
    </div>
  </header>
  <div class="breadcrumbs">
    {% if breadcrumbs %}
    {% for crumb in breadcrumbs %}
    {% if crumb.url %}
    <a href="{{ crumb.url }}">{{ crumb.name }}</a>
    <span>/</span>
    {% else %}
    <span>{{ crumb.name }}</span>
    {% endif %}
    {% endfor %}
    {% endif %}
  </div>
  <div class="container">
    <nav class="sidebar" aria-label="Sidebar navigation">
      <div style="margin-bottom: 12px;">
        <input type="search" placeholder="Filter by title"
          style="width: 90%; padding: 5px 8px; border-radius: 3px; border: 1px solid #ddd; font-size: 15px;">
      </div>
      <ul>
        <li><a href="#">Welcome to Teams</a></li>
        <li><a href="#">Get started</a></li>
        <li><a href="#" aria-current="page">Deployment overview</a></li>
        <li><a href="#">Enterprise setup</a></li>
        <li><a href="#">Small business setup</a></li>
        <li><a href="#">Upgrade from Skype for Business</a></li>
        <li><a href="#">Teams training</a></li>
        <li><a href="#">Security, compliance, and privacy</a></li>
        <li><a href="#">AI, Copilot, and agents in Teams</a></li>
        <li><a href="#">Teams Premium</a></li>
        <li><a href="#">Manage and monitor Teams</a></li>
        <li><a href="#">Teams chat, channels, and collaboration</a></li>
        <li><a href="#">Meetings and Audio Conferencing</a></li>
        <li><a href="#">Voice - Teams Calling, Phone, and PSTN connectivity</a></li>
        <li><a href="#">Teams devices and teleconferencing</a></li>
        <li><a href="#">Manage apps in Teams</a></li>
        <li><a href="#">Industries and government guidance</a></li>
        <li><a href="#">Reference</a></li>
      </ul>
    </nav>
    <main class="main-area">
      <h1>{{ title | default('IT Admins - Microsoft Teams deployment overview') }}</h1>
      <div class="meta">{{ meta | default('10/28/2024 &nbsp;•&nbsp; Applies to: Microsoft Teams') | safe }}</div>
      {% if tip_content %}
      <div class="tip-box">
        <span class="tip-icon" title="Tip">
          <svg width="20" height="20" viewBox="0 0 20 20">
            <circle cx="10" cy="10" r="10" fill="#73b563" /><text x="9" y="15" text-anchor="middle" fill="#fff"
              font-size="14" font-family="Segoe UI,Arial" font-weight="bold">i</text>
          </svg>
        </span>
        <div class="tip-content">
          {{ tip_content | safe }}
        </div>
      </div>
    
      {% endif %}
      {% if intro_paragraph %}
      <div class="para">
        {{ intro_paragraph | safe }}
      </div>
      {% endif %} 

      <!-- Dynamic Sections -->
      {% if sections %}
      {% for section in sections %}
      <section class="section" id="{{ section.id }}">
        <div class="section-header">
          <h2>{{ section.title }}</h2>
          <span class="switch">
            <div class="switch-slider" id="slider-{{ section.id }}" tabindex="0" aria-label="3-position slider" role="slider"
              aria-valuenow="1" aria-valuemin="1" aria-valuemax="3">
              <div class="slider-track">
                <div class="slider-dot active"></div>
                <div class="slider-dot"></div>
                <div class="slider-dot"></div>
                <div class="slider-thumb" style="left: 0%;"></div>
              </div>
            </div>
          </span>
        </div>
        <div class="section-content">
          {% for content_item in section.content %}
          {% if content_item.type == 'paragraph' %}
          <div class="para">{{ content_item.text | safe }}</div>
          {% elif content_item.type == 'list' %}
          <ul>
            {% for item in content_item.elements %}
            <li>{{ item | safe }}</li>
            {% endfor %}
          </ul>
          {% elif content_item.type == 'note' %}
          <div class="note-block">{{ content_item.text | safe }}</div>
          {% endif %}
          {% endfor %}
        </div>
      </section>
      {% endfor %}
    
      {% endif %}
      <section class="feedback-section">
        <div class="feedback-question">Was this page helpful?</div>
        <div class="feedback-buttons">
          <button>Yes</button>
          <button>No</button>
        </div>
        <a href="#" class="feedback-link">Provide product feedback</a>
      </section>
    </main>
    <aside class="right-nav">
      <div class="in-this-article">
        <h4>In this article</h4>
        <ul>
          {% if in_this_article %}
          {% for item in in_this_article %}
          <li><a href="{{ item.anchor }}">{{ item.title }}</a></li>
          {% endfor %}
          {% endif %}
        </ul>
      </div>
    </aside>
  </div>
  <footer>
    <div class="footer-links">
      <a href="#">English (United States)</a>
      <span class="privacy-choice">Your Privacy Choices</span>
      <span class="theme-select">Theme</span>
    </div>
    <div class="footer-links">
      <a href="#">Previous Versions</a>
      <a href="#">Blog</a>
      <a href="#">Contribute</a>
      <a href="#">Privacy</a>
      <a href="#">Terms of Use</a>
      <a href="#">Trademarks</a>
      <span>© Microsoft 2025</span>
    </div>
  </footer>
  <script>
    // Interactive 3-spot slider with proper alignment - works with multiple sliders
    (function () {
      // Function to initialize a single slider
      function initSlider(sliderId) {
        const slider = document.getElementById(sliderId);
        if (!slider) return; // Skip if slider doesn't exist
        
        const thumb = slider.querySelector('.slider-thumb');
        const dots = slider.querySelectorAll('.slider-dot');
        let pos = 0; // 0 - left, 1 - middle, 2 - right

        // These percentages align the center of the thumb with the center of the dots
        const positions = [0, 0.5, 1];

        function setSlider(position) {
          pos = position;
          // Calculate left as a percentage of track width
          // Since thumb uses transform: translate(-50%, -50%), this will center the thumb on the dot
          const percent = positions[pos] * 100 + "%";
          thumb.style.left = percent;

          if (dots[pos].classList.contains('active')) return; // No change if already active

          dots.forEach((dot, i) => {
            dot.classList.toggle('active', i === pos);
          });
          slider.setAttribute('aria-valuenow', pos + 1);

          // Send slider state to Flask
          sendSliderState(sliderId, position);
        }
        
        function sendSliderState(sliderId, position) {
          fetch('/slider-update', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              slider_id: sliderId,
              position: position,
              section_id: sliderId.replace('slider-', '')
            })
          })
          .then(response => response.json())
          .then(data => {
            console.log('Slider state updated:', data);
            // Handle response if needed
          })
          .catch(error => {
            console.error('Error updating slider state:', error);
          });
        }

        function getClosestSliderPos(event) {
          const rect = slider.getBoundingClientRect();
          const x = event.clientX - rect.left;
          const width = rect.width;
          if (x < width / 4) return 0;
          if (x > width * 3 / 4) return 2;
          return 1;
        }

        // Mouse click on slider
        slider.addEventListener('click', function (e) {
          if (e.target.classList.contains('slider-thumb')) return;
          const pos = getClosestSliderPos(e);
          setSlider(pos);
        });

        // Thumb drag
        let dragging = false;
        thumb.addEventListener('mousedown', function (e) {
          dragging = true;
          document.body.style.userSelect = "none";
          e.preventDefault();
        });
        document.addEventListener('mousemove', function (e) {
          if (!dragging) return;
          const sliderRect = slider.getBoundingClientRect();
          const x = e.clientX - sliderRect.left;
          const width = sliderRect.width;
          let pos;
          if (x < width / 4) pos = 0;
          else if (x > width * 3 / 4) pos = 2;
          else pos = 1;
          setSlider(pos);
        });
        document.addEventListener('mouseup', function () {
          if (dragging) {
            dragging = false;
            document.body.style.userSelect = "";
          }
        });

        // Keyboard navigation
        slider.addEventListener('keydown', function (e) {
          if (e.key === "ArrowRight" || e.key === "ArrowUp") {
            if (pos < 2) setSlider(pos + 1);
            e.preventDefault();
          } else if (e.key === "ArrowLeft" || e.key === "ArrowDown") {
            if (pos > 0) setSlider(pos - 1);
            e.preventDefault();
          }
        });

        // Set initial position
        setSlider(2);
      }

      // Initialize all sliders on the page
      document.addEventListener('DOMContentLoaded', function() {
        const sliders = document.querySelectorAll('.switch-slider');
        sliders.forEach(slider => {
          initSlider(slider.id);
        });
      });
    })();
  </script>
</body>

</html>